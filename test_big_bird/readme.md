The `quotes+contentAroundQuotes.py` file will use the booknlp outputs to print out all of the quotes found in the book as well as specified content around the quotes up to a amount of tokens in front and behind


The `quotes+whoSaidQuote+contentAroundQuotes.py` file will use the booknlp outputs to do everythign the program before did but ALSO will tell you who said each specified quotes 


The g_book folder is just a folder that contains the outputs of a booknlprun on a test bookk of guradians of gahhool but i think its just the first chapter anyway lol

The `bigbird.py` will train bigbird on the csv file named output.csv on the task of quotation attribution



current plans on how this model will me trained:

If you're planning to further train the BERT model, which has initially learned quotation attribution from BOOKNLP outputs, with additional data labeled by GPT-4, you are essentially engaging in a multi-stage training process that involves both knowledge distillation and fine-tuning with human-like labeled data.

1. **Knowledge Distillation:** The first stage, as previously described, where your BERT model learns from the outputs of BOOKNLP, distilling knowledge from it.

2. **Fine-Tuning with Enhanced Data:** The second stage involves further training or fine-tuning the model on quotation attribution data that has been labeled by GPT-4. Given GPT-4's capabilities in generating human-like text and understanding context, labels provided by GPT-4 could be highly nuanced and potentially superior in quality to straightforward labels. This stage aims to improve the BERT model's performance by leveraging high-quality, possibly more complex or nuanced, labeled data.

This process could be described as a hybrid approach, combining knowledge distillation with advanced fine-tuning. The idea is to first bootstrap the model's ability to understand and attribute quotations using the distilled knowledge from BOOKNLP and then refine and enhance its capabilities with rich, nuanced labels generated by an advanced model like GPT-4. The outcome is a specialized BERT model that is potentially better at quotation attribution than either of its teachers (BOOKNLP and the GPT-4-augmented labeling).

This approach leverages the strengths of both automated systems (BOOKNLP for initial knowledge and GPT-4 for depth and nuance in labeling) to create a model that excels at a specific task. It's a creative way to combine different AI technologies to achieve superior performance in specialized domains.




Update: when training the big bird model on the output.csv file with 20 steps I gotthe unpredicted result of generalization appearing in the model instead of overfitting????
LOG:
{'eval_loss': 2.8449819087982178, 'eval_accuracy': 0.5238095238095238, 'eval_runtime': 0.0735, 'eval_samples_per_second': 285.846, 'eval_steps_per_second': 27.223, 'epoch': 20.0}
{'train_runtime': 57.3258, 'train_samples_per_second': 63.846, 'train_steps_per_second': 8.024, 'train_loss': 3.162827612006146, 'epoch': 20.0}
100%|█████████████████████████████████████████████████████████████████████████████████| 460/460 [00:57<00:00,  8.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 85.16it/s]
{'eval_loss': 2.8449819087982178, 'eval_accuracy': 0.5238095238095238, 'eval_runtime': 0.0733, 'eval_samples_per_second': 286.389, 'eval_steps_per_second': 27.275, 'epoch': 20.0}
100%|███████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1562.71it/s]
Text: During the intense chess tournament, a prodigy declared, 'Every move must be calculated with precision and foresight.' The grandmasters, spectators, and fellow competitors marveled at the young talent's strategic brilliance.
Predicted label: coach

Text: During the investor pitch, the startup founder stated, 'Our mission is to make a positive impact on society.' The investors were intrigued by the socially conscious approach.
Predicted label: founder

Text: During the brainstorming session, Lily proposed, 'What if we created a loyalty program to retain our customers?' Noah thought it could foster long-term relationships.
Predicted label: Liam


Update: Fixed the genation of tranining data csv to actualyl work and be fixed, now it generates a giant csv file to train from that contains quotes, and their context, and who said the quote, There is a optional parameter that is turned off right now to allow any "Unknown" entities to be in the list so its only known entities, and everything is still in quotes in the training data for the quotes themselves, I also added a automated cleanup script to unktokenize the text in the csv file cause booknlp sometimes messes things up, planning on later traying to make it outpreform booknlp by hvaing it figure who said what and also identiofy if something is a quote or not but that might have to be a second model to accomplish that

In the meantime: the current reselts after training big bird on 3 guardians of gahool books i got good promicing results, getting 30% accuracy already!
{'train_runtime': 143.3931, 'train_samples_per_second': 59.103, 'train_steps_per_second': 7.406, 'train_loss': 3.2177001608293607, 'epoch': 3.0}
100%|███████████████████████████████████████████████████████████████████████████████| 1062/1062 [02:23<00:00,  7.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████| 20/20 [00:00<00:00, 21.70it/s]
{'eval_loss': 2.734614372253418, 'eval_accuracy': 0.3184713375796178, 'eval_runtime': 0.9758, 'eval_samples_per_second': 321.802, 'eval_steps_per_second': 20.497, 'epoch': 3.0}
100%|███████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1178.84it/s]
Formatted Input: mum told me that, and it is true. For indeed with that ancient order began a special kind of bird. As owls, we owe our uniqueness, our ability to fly silently, to see through the darkness of the night, to spin our heads almost all the way around to those first owls. And you know from navigation that we call our grandest constellation that shines through every season the Great Glaux. But for those owls that Eglantine talked about, that was not enough. They want to destroy all the others.” They were all dismayed by Otulissa’s gracious speech. Soren thought that she must have been eavesdropping more than once to have learned all this. She almost started to blubber now with tears and chokes. It was the most un- Otulissa moment any of them had ever witnessed.“ I feel so strongly about this. You know me, I’m not an emotional kind of owl but this… this… I… I can’t explain, but you must let me be a part of this.”“ Of course,” Soren said. Otulissa was very smart and beyond being smart, she of all of them possessed the most sensitivity to atmospheric pressure changes. She had proved herself invaluable to the weather chaw. And this would be the best of the best of the chaws! Indeed, it would be the chaw of chaws! CHAPTER SIXTEEN The Empty Shrine They had picked an evening to leave when there were no classes and no chaw practices, but still they were careful to leave the tree in twos or threes near First Black and then once again take off from the cliffs where they would not be spotted. And they all, even the smallest, wore battle claws. They had filched them from the armory in the forge. Bubo happened to be gone so it was not a problem. Twilight had gone early in the morning of their flight and taken them from the forge and placed them in the crags of the cliffs. Soren had insisted that they practice with the claws, for none of them had flown that often with them. Eglantine had never flown“ : quote in text “ Of course,”
Predicted Entity: Soren
Formatted Input: had been on the mission to rescue Ezylryb that Soren had discovered that his own brother, Kludd, was the leader of this group. Matron, a bunchy Barred Owl, poked her beak out of an opening near the branch where Soren and the others perched.“ Breaklight!” she announced cheerfully.“ At last!” Soren said.“ Ooh, bats! I smell roasted bat wings!” Gylfie suddenly swooped in.“ Where’ve you been?” Soren turned to the Elf Owl.“ Helping Octavia in the library,” she replied.“ Octavia in the library? Why?” Soren asked.“ Orders from the top, I guess. We were supposed to organize all the books on higher magnetics and flecks.” Soren felt his gizzard lurch. He would never get used to hearing the word“ flecks.”“ But Octavia? Why Octavia? What use is a blind snake in the library? No offense, Mrs. P.,” Otulissa asked as they crowded around Mrs. Plithiver, another blind snake.“ None taken, dear,” the rosy- colored snake replied. For centuries, blind snakes had served as maids in the nests of owls, keeping them free of vermin and pests. In the Great Ga’Hoole Tree, they served in other tasks as well. Among such tasks were providing the dining tables upon which the owls ate. They could easily and quickly extend their bodies to accommodate more diners. Answering Otulissa’s question, Gylfie replied,“ Why Octavia? Well, she might be blind, but she has served Ezylryb for so long that she knows which books he wants on the special reserve shelf for higher magnetics. And it was too much work for just the book matron. She doesn’t know the collection as well as Octavia— at least not these books. But then, of course, Dewlap came in and started bossing us around.” There was a sigh from the owls. Dewlap was the most boring teacher, or ryb, of the Great Ga’Hoole Tree.“ What’s she doing in the library?” Soren asked.“ Higher magnetics has : quote in text “ None taken, dear,”
Predicted Entity: Soren
Formatted Input: fleck ever will.” And so it was arranged. Gylfie and Soren would be given passes to help in the inventory area, the inventorium, each night during the newing and on various nights until the moon was full again and all owlets were required in the glaucidium for moon blinking. Their first lesson would begin that very evening. CHAPTER TWENTY- ONE To Fly More flap, deeper flap. Your wings must almost meet on the upstroke of the flap…” Grimble directed. Soren and Gylfie were exhausted. This was much harder than anything either one of them had ever seen their parents or older siblings try to do.“ I know you’re tired, but the only way out of here is straight up. You have to build your muscles. That’s why I am not even having you practice hopping or branching. You do not have the luxury of gliding gently down from a nest. You have to develop your power- flight skills. So try it again.”“ But once we’re out,” Soren asked,“ how will we know what to do?”“ You’ll know. What did I tell you? The still air has no shape. In the sky you will feel the mass of air as it moves around your wings. You will sense its speed, if it is bumpy or smooth, hot or cold. And you will know how to shape it and use it. Wind always has shape but there is no wind in St. Aggie’s. It is too deep for the wind to reach. And in these small spaces it is hard to even feel the air. It is dead, unmoving air in here. So you must work extra hard to give it a shape with your power strokes, your flapping. Your downstroke is your most powerful. On your upstroke, you want the air to flow through easily. That is why both of you have those feathers with slots, tip slots at the end of your wings. They separate and let you go up easily.” Grimble demonstrated. He pressed forward just a bit, extended his head, and lifted his wings. : quote in text “ how will we know what to do?”
Predicted Entity: Gylfie




Update: Results after training on 10 books from guardians of gahool for 3 epoches it gets a rating of 35.25% accuracy so its still improving with scale! ILL just have to try training it on way more books!
{'eval_loss': 2.692739248275757, 'eval_accuracy': 0.3525243578387954, 'eval_runtime': 3.4342, 'eval_samples_per_second': 328.756, 'eval_steps_per_second': 20.675, 'epoch': 3.0}
{'train_runtime': 521.9264, 'train_samples_per_second': 58.399, 'train_steps_per_second': 7.3, 'train_loss': 3.235308501476378, 'epoch': 3.0}
100%|███████████████████████████████████████████████████████████████████████████████| 3810/3810 [08:41<00:00,  7.30it/s]
100%|███████████████████████████████████████████████████████████████████████████████████| 71/71 [00:03<00:00, 21.15it/s]
{'eval_loss': 2.692739248275757, 'eval_accuracy': 0.3525243578387954, 'eval_runtime': 3.4059, 'eval_samples_per_second': 331.48, 'eval_steps_per_second': 20.846, 'epoch': 3.0}
100%|███████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1048.31it/s]
Formatted Input: after his escape from St. Aggie’s. She had told him what Soren had long suspected— that it was his older brother, Kludd, who had pushed him from the nest when his parents were out hunting. Although he had survived the fall, still being flightless he was prey to any ground animal. Ground animal! Who would have ever thought another owl would be the greatest danger? Until that moment when he was snatched and felt himself being carried into the night sky by a pair of talons, Soren had thought that the worst predator in the forest, from an owl’s point of view, was a raccoon. And then Mrs. P. told him that she had suspected that Kludd had done the same thing to Eglantine, his baby sister. When Mrs. P. had protested, Kludd had threatened to eat her. So the poor old snake had no choice but to leave— very quickly. Now Mrs. P. slithered toward Soren’s left ear, the higher ear and the easiest for her to reach.“ Soren,” she whispered,“ I’m not sure if it is a good idea to keep flying with all this light. We don’t want to get mobbed.”“ Mobbed?” Soren asked.“ You know, crows.” Soren felt a chill run through his gizzard. Perhaps if Mrs. Plithiver had not been whispering her warning in his ear he might have heard the chuffing sound of wings, and not owl wings, overhead.“ Crow to windward!” Gylfie cried. And then suddenly the rosy dawn sky turned black.“ We’re being mobbed!” shrieked Twilight. Oh, Glaux! thought Soren. This was the worst thing that could befall any owl flying in the daytime. But it was still very early. Crows at night were fine. Owls were crows’ worst enemies at night. They could attack them as they slept, but crows during the day were something else. Crows in daylight were terrible. If a crow discovered an owl during the daytime, even if it was just one crow, that bird had a way of signaling others and soon an entire flock would arrive and mob the owls, diving at their heads with their sharp beaks, trying to tear out : quote in text “ I’m not sure if it is a good idea to keep flying with all this light. We don’t want to get mobbed.”
Predicted Entity: Soren
Formatted Input: , each owl flying close to its buddy. They were not halfway to the next ridge when they saw the thick smoke, almost white in the night, rolling up, and then the tongues of flame dancing against the night. Ezylryb began a steeply banking turn. The others followed. Bubo and Poot arrived shortly with fresh voles and mice in their talons, some still squirming.“ Eat light, eat all the hair!” Ezylryb barked.“ I wonder why he always calls it hair?” Martin said quietly.“ They say he comes from a distant place called the land of the Great North Waters and they have odd ways of speaking,” Ruby said.“ But hair? What’s hair?” Martin persisted.“ Well, there’s fur and there’s feathers— I think it’s something in between,” Ruby said.“ Do you want me to ask Otulissa?”“ No!” Soren and Martin both groaned. Less than an hour had passed when Bubo flew down from his higher perch.“ Prepare to fly.” The owls stood on the thin granite lip of the ridge, their talons hooked over the edge. They spread their wings, and Bubo gave the command.“ FIRE!” They lifted off— first Bubo and Elvan, then Ruby and Poot, next Otulissa, Soren, and Martin, and last, as a rear guard, Ezyl- ryb. They had not flown very far before they felt the heat on their faces. They had anticipated the heat but not the noise. A monster roar raged in their ears. Soren had never heard anything like it. Bubo and Elvan had prepared them for everything but this noise. They knew about the heat. They knew about the violent updrafts, the so- called cool spots, and the dead falls. They even knew about the most dreaded trick fire could pull— fire blinking. This happened when the fire, raging with all its deadly beauty, actually transfixed an owl so that it could not fly. It went yeep and, with its wings locking, the owl lost its instincts : quote in text “ Prepare to fly.”
Predicted Entity: Soren
Formatted Input: Soren studied the big owl. He seemed young despite his size. He didn’t want to be rude but he was genuinely curious about this owl.“ Are you from these parts?” Soren asked.“ Here, there, everywhere,” the owl replied.“ You name it, I’ve been there.” He had a rough manner of speaking that was slightly intimidating. Gylfie hopped out toward the end of the branch.“ I want to thank you for your kindness in advising me on my predicament.” Soren blinked. He had never heard Gylfie speak this way. She sounded so much older than she was, and extremely courteous.“ We don’t mean to be rude but we have never seen an owl of your size. May we be so bold as to inquire as to your species?” Species! Soren thought. Where in the name of Glaux did Gylfie come up with these words?“ Species? What the Glaux is that? Very fancy word for a Great Gray Owl like myself.”“ Oh, so you are a Great Gray. I’ve heard of them, though there were none in Kuneer,” Gylfie said.“ Ah, Kuneer! Been there. No, not a good place for Great Grays. As a matter of fact, I can’t really tell you where I’m from. See, I was orphaned at a very young age. Plucked up by a St. Aggie’s patrol but managed to drop right into an abandoned nest.”“ You escaped from a St. Aggie’s patrol?”“ You bet. There was no way those idiots were going to take me. Not alive. I bided my time, then bit my snatcher’s second talon clean off. He dropped me like a hot coal. They never messed with me again. Word went out, I s’pose.” He swaggered a bit, then strutted toward the end of the branch. Now even Gylfie was speechless. Finally, Soren spoke.“ We were snatched as well and only now escaped. I, myself, am from the Kingdom of Tyto, and both Gylfie and I want to find our families again. But we have no idea : quote in text “ Oh, so you are a Great Gray. I’ve heard of them, though there were none in Kuneer,”
Predicted Entity: Gylfie
