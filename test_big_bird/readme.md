The `quotes+contentAroundQuotes.py` file will use the booknlp outputs to print out all of the quotes found in the book as well as specified content around the quotes up to a amount of tokens in front and behind


The `quotes+whoSaidQuote+contentAroundQuotes.py` file will use the booknlp outputs to do everythign the program before did but ALSO will tell you who said each specified quotes 


The g_book folder is just a folder that contains the outputs of a booknlprun on a test bookk of guradians of gahhool but i think its just the first chapter anyway lol

The `bigbird.py` will train bigbird on the csv file named output.csv on the task of quotation attribution



current plans on how this model will me trained:

If you're planning to further train the BERT model, which has initially learned quotation attribution from BOOKNLP outputs, with additional data labeled by GPT-4, you are essentially engaging in a multi-stage training process that involves both knowledge distillation and fine-tuning with human-like labeled data.

1. **Knowledge Distillation:** The first stage, as previously described, where your BERT model learns from the outputs of BOOKNLP, distilling knowledge from it.

2. **Fine-Tuning with Enhanced Data:** The second stage involves further training or fine-tuning the model on quotation attribution data that has been labeled by GPT-4. Given GPT-4's capabilities in generating human-like text and understanding context, labels provided by GPT-4 could be highly nuanced and potentially superior in quality to straightforward labels. This stage aims to improve the BERT model's performance by leveraging high-quality, possibly more complex or nuanced, labeled data.

This process could be described as a hybrid approach, combining knowledge distillation with advanced fine-tuning. The idea is to first bootstrap the model's ability to understand and attribute quotations using the distilled knowledge from BOOKNLP and then refine and enhance its capabilities with rich, nuanced labels generated by an advanced model like GPT-4. The outcome is a specialized BERT model that is potentially better at quotation attribution than either of its teachers (BOOKNLP and the GPT-4-augmented labeling).

This approach leverages the strengths of both automated systems (BOOKNLP for initial knowledge and GPT-4 for depth and nuance in labeling) to create a model that excels at a specific task. It's a creative way to combine different AI technologies to achieve superior performance in specialized domains.




Update: when training the big bird model on the output.csv file with 20 steps I gotthe unpredicted result of generalization appearing in the model instead of overfitting????
LOG:
{'eval_loss': 2.8449819087982178, 'eval_accuracy': 0.5238095238095238, 'eval_runtime': 0.0735, 'eval_samples_per_second': 285.846, 'eval_steps_per_second': 27.223, 'epoch': 20.0}
{'train_runtime': 57.3258, 'train_samples_per_second': 63.846, 'train_steps_per_second': 8.024, 'train_loss': 3.162827612006146, 'epoch': 20.0}
100%|█████████████████████████████████████████████████████████████████████████████████| 460/460 [00:57<00:00,  8.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 85.16it/s]
{'eval_loss': 2.8449819087982178, 'eval_accuracy': 0.5238095238095238, 'eval_runtime': 0.0733, 'eval_samples_per_second': 286.389, 'eval_steps_per_second': 27.275, 'epoch': 20.0}
100%|███████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1562.71it/s]
Text: During the intense chess tournament, a prodigy declared, 'Every move must be calculated with precision and foresight.' The grandmasters, spectators, and fellow competitors marveled at the young talent's strategic brilliance.
Predicted label: coach

Text: During the investor pitch, the startup founder stated, 'Our mission is to make a positive impact on society.' The investors were intrigued by the socially conscious approach.
Predicted label: founder

Text: During the brainstorming session, Lily proposed, 'What if we created a loyalty program to retain our customers?' Noah thought it could foster long-term relationships.
Predicted label: Liam


Update: Fixed the genation of tranining data csv to actualyl work and be fixed, now it generates a giant csv file to train from that contains quotes, and their context, and who said the quote, There is a optional parameter that is turned off right now to allow any "Unknown" entities to be in the list so its only known entities, and everything is still in quotes in the training data for the quotes themselves, I also added a automated cleanup script to unktokenize the text in the csv file cause booknlp sometimes messes things up, planning on later traying to make it outpreform booknlp by hvaing it figure who said what and also identiofy if something is a quote or not but that might have to be a second model to accomplish that

In the meantime: the current reselts after training big bird on 3 guardians of gahool books i got good promicing results, getting 30% accuracy already!
{'train_runtime': 143.3931, 'train_samples_per_second': 59.103, 'train_steps_per_second': 7.406, 'train_loss': 3.2177001608293607, 'epoch': 3.0}
100%|███████████████████████████████████████████████████████████████████████████████| 1062/1062 [02:23<00:00,  7.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████| 20/20 [00:00<00:00, 21.70it/s]
{'eval_loss': 2.734614372253418, 'eval_accuracy': 0.3184713375796178, 'eval_runtime': 0.9758, 'eval_samples_per_second': 321.802, 'eval_steps_per_second': 20.497, 'epoch': 3.0}
100%|███████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1178.84it/s]
Formatted Input: mum told me that, and it is true. For indeed with that ancient order began a special kind of bird. As owls, we owe our uniqueness, our ability to fly silently, to see through the darkness of the night, to spin our heads almost all the way around to those first owls. And you know from navigation that we call our grandest constellation that shines through every season the Great Glaux. But for those owls that Eglantine talked about, that was not enough. They want to destroy all the others.” They were all dismayed by Otulissa’s gracious speech. Soren thought that she must have been eavesdropping more than once to have learned all this. She almost started to blubber now with tears and chokes. It was the most un- Otulissa moment any of them had ever witnessed.“ I feel so strongly about this. You know me, I’m not an emotional kind of owl but this… this… I… I can’t explain, but you must let me be a part of this.”“ Of course,” Soren said. Otulissa was very smart and beyond being smart, she of all of them possessed the most sensitivity to atmospheric pressure changes. She had proved herself invaluable to the weather chaw. And this would be the best of the best of the chaws! Indeed, it would be the chaw of chaws! CHAPTER SIXTEEN The Empty Shrine They had picked an evening to leave when there were no classes and no chaw practices, but still they were careful to leave the tree in twos or threes near First Black and then once again take off from the cliffs where they would not be spotted. And they all, even the smallest, wore battle claws. They had filched them from the armory in the forge. Bubo happened to be gone so it was not a problem. Twilight had gone early in the morning of their flight and taken them from the forge and placed them in the crags of the cliffs. Soren had insisted that they practice with the claws, for none of them had flown that often with them. Eglantine had never flown“ : quote in text “ Of course,”
Predicted Entity: Soren
Formatted Input: had been on the mission to rescue Ezylryb that Soren had discovered that his own brother, Kludd, was the leader of this group. Matron, a bunchy Barred Owl, poked her beak out of an opening near the branch where Soren and the others perched.“ Breaklight!” she announced cheerfully.“ At last!” Soren said.“ Ooh, bats! I smell roasted bat wings!” Gylfie suddenly swooped in.“ Where’ve you been?” Soren turned to the Elf Owl.“ Helping Octavia in the library,” she replied.“ Octavia in the library? Why?” Soren asked.“ Orders from the top, I guess. We were supposed to organize all the books on higher magnetics and flecks.” Soren felt his gizzard lurch. He would never get used to hearing the word“ flecks.”“ But Octavia? Why Octavia? What use is a blind snake in the library? No offense, Mrs. P.,” Otulissa asked as they crowded around Mrs. Plithiver, another blind snake.“ None taken, dear,” the rosy- colored snake replied. For centuries, blind snakes had served as maids in the nests of owls, keeping them free of vermin and pests. In the Great Ga’Hoole Tree, they served in other tasks as well. Among such tasks were providing the dining tables upon which the owls ate. They could easily and quickly extend their bodies to accommodate more diners. Answering Otulissa’s question, Gylfie replied,“ Why Octavia? Well, she might be blind, but she has served Ezylryb for so long that she knows which books he wants on the special reserve shelf for higher magnetics. And it was too much work for just the book matron. She doesn’t know the collection as well as Octavia— at least not these books. But then, of course, Dewlap came in and started bossing us around.” There was a sigh from the owls. Dewlap was the most boring teacher, or ryb, of the Great Ga’Hoole Tree.“ What’s she doing in the library?” Soren asked.“ Higher magnetics has : quote in text “ None taken, dear,”
Predicted Entity: Soren
Formatted Input: fleck ever will.” And so it was arranged. Gylfie and Soren would be given passes to help in the inventory area, the inventorium, each night during the newing and on various nights until the moon was full again and all owlets were required in the glaucidium for moon blinking. Their first lesson would begin that very evening. CHAPTER TWENTY- ONE To Fly More flap, deeper flap. Your wings must almost meet on the upstroke of the flap…” Grimble directed. Soren and Gylfie were exhausted. This was much harder than anything either one of them had ever seen their parents or older siblings try to do.“ I know you’re tired, but the only way out of here is straight up. You have to build your muscles. That’s why I am not even having you practice hopping or branching. You do not have the luxury of gliding gently down from a nest. You have to develop your power- flight skills. So try it again.”“ But once we’re out,” Soren asked,“ how will we know what to do?”“ You’ll know. What did I tell you? The still air has no shape. In the sky you will feel the mass of air as it moves around your wings. You will sense its speed, if it is bumpy or smooth, hot or cold. And you will know how to shape it and use it. Wind always has shape but there is no wind in St. Aggie’s. It is too deep for the wind to reach. And in these small spaces it is hard to even feel the air. It is dead, unmoving air in here. So you must work extra hard to give it a shape with your power strokes, your flapping. Your downstroke is your most powerful. On your upstroke, you want the air to flow through easily. That is why both of you have those feathers with slots, tip slots at the end of your wings. They separate and let you go up easily.” Grimble demonstrated. He pressed forward just a bit, extended his head, and lifted his wings. : quote in text “ how will we know what to do?”
Predicted Entity: Gylfie
